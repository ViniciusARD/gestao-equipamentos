<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Verificação de Conta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="login-container">
        <div class="login-box text-center">
            <h2 id="title">Verificando...</h2>
            <div id="spinner" class="spinner-border my-4" style="width: 3rem; height: 3rem;"></div>
            <p id="message" class="mt-3"></p>
            <a href="login.html" id="loginLink" class="btn btn-primary d-none">Ir para o Login</a>
        </div>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const token = urlParams.get('token');
            const titleEl = document.getElementById('title');
            const messageEl = document.getElementById('message');
            const spinnerEl = document.getElementById('spinner');
            const loginLink = document.getElementById('loginLink');

            if (!token) {
                titleEl.textContent = 'Erro!';
                messageEl.textContent = 'Token de verificação não encontrado.';
                spinnerEl.classList.add('d-none');
                return;
            }

            try {
                const response = await fetch(`http://127.0.0.1:8000/auth/verify-email?token=${token}`);
                const result = await response.json();
                
                spinnerEl.classList.add('d-none');

                if (response.ok) {
                    titleEl.textContent = 'Sucesso!';
                    titleEl.classList.add('text-success');
                    messageEl.textContent = result.message;
                    loginLink.classList.remove('d-none');
                } else {
                    titleEl.textContent = 'Erro!';
                    titleEl.classList.add('text-danger');
                    messageEl.textContent = `Erro: ${result.detail || 'Não foi possível verificar a conta.'}`;
                }
            } catch (error) {
                titleEl.textContent = 'Erro de Conexão!';
                titleEl.classList.add('text-danger');
                messageEl.textContent = 'Não foi possível conectar ao servidor.';
                spinnerEl.classList.add('d-none');
            }
        });
    </script>
</body>
</html>